# Part 1: RNA-seq Reads Count Pipeline

This is a Python-based pipeline for processing RNA-seq data from raw FASTQ files to read count generation using standard bioinformatics tools.

This script performs the following steps:

1. **Quality Control (FastQC)** ‚Äì Performs quality check on raw FASTQ files.
2. **Genome Alignment (HISAT2)** ‚Äì Aligns reads to the reference genome.
3. **Read Counting (HTSeq-count)** ‚Äì Generates count data per gene using annotated features.
4. **(Optional)** PCA clustering analysis on the expression matrix.

The script is designed for **paired-end RNA-seq data**, where files end with `_1.fq.gz` and `_2.fq.gz`.

## üîß Requirements
Make sure the following software and Python packages are installed:

### Conda-installed tools
```bash
conda install -c bioconda fastqc
conda install -c bioconda hisat2
conda install -c bioconda samtools
conda install -c bioconda htseq

### Python packages
```bash
pip install pandas scikit-learn matplotlib seaborn

‚ö†Ô∏è You may need to use a virtual environment if you're in a restricted or externally managed system
```bash
python3 -m venv env
source env/bin/activate
pip install pandas scikit-learn matplotlib seaborn

üß¨ Input Files
‚Ä¢	FastQ/ folder containing paired-end .fq.gz files (e.g., sample1_1.fq.gz, sample1_2.fq.gz)
‚Ä¢	HISAT2 indexed reference genome
‚Ä¢	GFF/GTF annotation file for use with HTSeq
‚ñ∂Ô∏è How to Run
python RNA-seq-ReadsCount.py -i Fastq -o hisat-count-dir -g /path/to/hisat2_index_RefGenome -a /path/to/RefGenome_annotation.gff3
Arguments:
Argument	Description
-i / --input	Directory containing FASTQ files
-o / --output	Output directory for htseq-count results
-g / --genome	Path to HISAT2 genome index (without .1.ht2 etc.)
-a / --gff	GFF3 or GTF file for gene annotations

üìÇ Output
‚Ä¢	FastQC_reports/: Quality check reports for each FASTQ file
‚Ä¢	aligned_bam_files/: BAM files generated from HISAT2
‚Ä¢	hisat-count-dir/: Read count tables for each sample
‚Ä¢	pca_plot.png: PCA clustering of samples based on expression matrix (if used)
üì£ Notes
‚Ä¢	Make sure the reference genome is properly indexed with hisat2-build.
‚Ä¢	BAM files are filtered and sorted using samtools.
‚Ä¢	HTSeq expects the BAM files to be sorted by position.

Part 2: Differential Expression Analysis (DEG) from RNA-seq Read Counts
Script: run-DEG-analysis.py
This Python-based script performs differential gene expression analysis from read count matrices using the R package DESeq2, and generates filtered/unfiltered result files, heatmaps, and summary tables for downstream interpretation.
 
üîç Overview
This script automates the process of identifying differentially expressed genes (DEGs) between experimental conditions using a design where:
Example Input Format
python run-DEG-analysis.py counts.txt group1_rep1,group1_rep2,group1_rep3 group2_rep1,group2_rep2,group2_rep3 group3_rep1,group3_rep2,group3_rep3
‚Ä¢	The first group (group1) is the control
‚Ä¢	group2 and group3 are test conditions to be compared with group1
‚Ä¢	All replicates are comma-separated
‚öôÔ∏è Functionality
This script performs:
1.	Input Parsing: Reads a raw count table and defines sample groups
2.	DESeq2-based DEG Analysis: For each test group vs control, runs DESeq2 in R via rpy2
3.	Results Export:
o	Unfiltered results: *_unfiltered.csv
o	Filtered (padj < 0.05, |log2FC| >= 1): *_filtered.csv
o	Combined summary CSVs: summary_all_DEG.csv, summary_filtered_DEG.csv
4.	Heatmap Generation: Heatmaps for DEGs for each comparison
 
üîß Requirements
üß¨ R Packages
Install DESeq2 via conda:
conda install -c bioconda bioconductor-deseq2
üêç Python Environment
Install required packages via pip or conda:
Conda-based environment (recommended):
conda install -c conda-forge rpy2
conda install pandas matplotlib seaborn scikit-learn
Alternatively, pip:
pip install rpy2 pandas matplotlib seaborn scikit-learn
‚ö†Ô∏è Note: Ensure that your Python and R environments are compatible when using rpy2 (e.g., Python 3.10 + R 4.2.x)
 
üìÇ Input Files
‚Ä¢	counts.txt: Gene expression matrix (rows = genes, columns = samples)
o	Generated by RNA-seq-ReadsCount.py
‚Ä¢	Sample names must match across:
o	counts.txt header
o	Input sample list to this script
 
‚ñ∂Ô∏è How to Run
python run-DEG-analysis.py counts.txt control_rep1,control_rep2,... case1_rep1,... case2_rep1,...
Example:
python run-DEG-analysis.py counts.txt WT_1,WT_2,WT_3 KO1_1,KO1_2,KO1_3 KO2_1,KO2_2,KO2_3
 
üì§ Output Files
All output files are saved in a folder called DEG_results/:
File	Description
*_filtered.csv	DEGs with padj < 0.05 and	log2FC	>= 1
*_unfiltered.csv	Full DESeq2 results		
*_heatmap.png	Clustered heatmap of top 50 DEGs		
summary_all_DEG.csv	Combined full results from all comparisons		
summary_filtered_DEG.csv	Combined filtered DEGs		
 
üìå Notes
‚Ä¢	You can include multiple test groups; all will be compared independently to the first group (control)
‚Ä¢	The script supports flexible group input, useful for multiple conditions
‚Ä¢	DESeq2 internally handles library size normalization and dispersion estimation
 
üß™ Suggested Workflow
1.	Run RNA-seq-ReadsCount.py to generate counts.txt
2.	Use run-DEG-analysis.py to analyze DEGs and visualize heatmaps


